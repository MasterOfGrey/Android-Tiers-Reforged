<?xml version="1.0" encoding="utf-8" ?>
<Defs>

	<ThingDef ParentName="DrugBase">
		<defName>ATR_FractalPill</defName>
		<label>Fractal pill</label>
		<description>Like all things related to archotechs, it is impossible to know what exactly this is. The only remnants of those warped by fractal power, these small pill-like objects can imbue a new host with that same fractal power. Rumor has it that archotechs whisper in the ears of those warped by it, offering a glimpse of true power. \n\nIn organics, this leads to warping of the mind and flesh - some believe it is enlightenment, others nightmares incarnate. It violently expunges diseases and mutates the very essence of its host. The vast majority of the time this will eventually lead to becoming a horrific monster, but madmen rant about the possibility for "the chosen" to "ascend to blessed fragmentation" instead.\n\nIn mechanicals, fractal warping has a much more tame effect. It integrates with the chassis and provides numerous beneficial effects ranging from enhanced cognition to ridiculous temperature tolerance. It does, however, occasionally warp internal storage and force reboots to defragment memory.</description>
		<graphicData>
			<texPath>Things/Drugs/FractalP</texPath>
			<graphicClass>Graphic_StackCount</graphicClass>
		</graphicData>
		<socialPropernessMatters>false</socialPropernessMatters>
		<rotatable>false</rotatable>
		<stackLimit>10</stackLimit>
        <useHitPoints>false</useHitPoints>
		<statBases>
			<MarketValue>1200</MarketValue>
			<Mass>0.4</Mass>
            <DeteriorationRate>0</DeteriorationRate>
            <Flammability>0</Flammability>
		</statBases>
		<techLevel>Ultra</techLevel>
		<ingestible>
			<foodType>Processed</foodType>
			<drugCategory>Medical</drugCategory>
			<ingestHoldUsesTable>false</ingestHoldUsesTable>
			<ingestCommandString>Consume {0}</ingestCommandString>
			<ingestReportString>Consuming {0}.</ingestReportString>
			<useEatingSpeedStat>false</useEatingSpeedStat>
			<outcomeDoers>
				<li Class="ATReforged.IngestionOutcomeDoer_MechOrganicDifferentEffects">
					<organicEffect>ATR_FractalPillOrganic</organicEffect>
                    <organicSeverity>0.25</organicSeverity>
					<mechanicalEffect>ATR_FractalPillMechanical</mechanicalEffect>
					<mechanicalSeverity>0.25</mechanicalSeverity>
				</li> 	
			</outcomeDoers>
		</ingestible>
		<comps>
			<li Class="CompProperties_Drug">
				<listOrder>806</listOrder>
			</li>
		</comps>
	</ThingDef>

	<HediffDef>
		<defName>ATR_FractalPillOrganic</defName>
		<hediffClass>ATReforged.Hediff_Fractal</hediffClass>
		<label>Fractal Warping</label>
		<description>Fractal warping of the body. As flesh toughens and takes on metallic qualities and the mind rots and yet also grows, a uniquely enlightening and agonizing perspective takes hold. This is the archotech's work, but for what inscrutable purpose was this warping manifested?</description>
		<comps>
            <li Class="HediffCompProperties_HealPermanentWounds" />
		</comps>
		<defaultLabelColor>(255, 130, 0)</defaultLabelColor>
		<scenarioCanAdd>true</scenarioCanAdd>
        <initialSeverity>0.25</initialSeverity>
		<maxSeverity>0.5</maxSeverity>
		<isBad>true</isBad>
		<stages>
			<li>
				<minSeverity>0.0</minSeverity>
				<label>Transcendant</label>
				<painFactor>2</painFactor>
				<vomitMtbDays>16</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.6</offset>
					</li>
					<li>
						<capacity>Talking</capacity>
						<offset>0.8</offset>
					</li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>0.8</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
				<statOffsets>
					<GlobalLearningFactor>1</GlobalLearningFactor>
					<MentalBreakThreshold>0.16</MentalBreakThreshold>
				</statOffsets>
			</li>
			<li>
				<minSeverity>0.05</minSeverity>
				<label>Blessed</label>
				<painFactor>1.5</painFactor>
				<vomitMtbDays>16</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.3</offset>
					</li>
					<li>
						<capacity>Talking</capacity>
						<offset>0.4</offset>
					</li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>0.4</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
				<statOffsets>
					<GlobalLearningFactor>0.5</GlobalLearningFactor>
					<MentalBreakThreshold>0.08</MentalBreakThreshold>
				</statOffsets>
			</li>
			<li>
				<minSeverity>0.15</minSeverity>
				<label>Gifted</label>
				<painFactor>1.25</painFactor>
				<vomitMtbDays>8</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.15</offset>
					</li>
					<li>
						<capacity>Talking</capacity>
						<offset>0.2</offset>
					</li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>0.2</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
				<statOffsets>
					<GlobalLearningFactor>0.25</GlobalLearningFactor>
					<MentalBreakThreshold>0.04</MentalBreakThreshold>
				</statOffsets>
			</li>
			<li>
				<minSeverity>0.25</minSeverity>
				<label>Balanced</label>
				<vomitMtbDays>4</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.15</offset>
					</li>
					<li>
						<capacity>Talking</capacity>
						<offset>0.2</offset>
					</li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>0.2</offset>
                    </li>
					<li>
						<capacity>Manipulation</capacity>
						<offset>0.2</offset>
					</li>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>0.2</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
			</li>
			<li>
				<minSeverity>0.35</minSeverity>
				<label>Tainted</label>
				<painFactor>0.75</painFactor>
				<vomitMtbDays>2</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.15</offset>
					</li>
					<li>
						<capacity>Manipulation</capacity>
						<offset>0.2</offset>
					</li>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>0.2</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
                <statFactors>
                    <IncomingDamageFactor>0.8</IncomingDamageFactor>
                </statFactors>
			</li>
			<li>
				<minSeverity>0.45</minSeverity>
				<label>Vile</label>
				<painFactor>0.5</painFactor>
				<vomitMtbDays>1</vomitMtbDays>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.3</offset>
					</li>
					<li>
						<capacity>Manipulation</capacity>
						<offset>0.4</offset>
					</li>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>0.4</offset>
                    </li>
					<li>
						<capacity>BloodPumping</capacity>
						<offset>0.2</offset>
					</li>
					<li>
						<capacity>BloodFiltration</capacity>
						<offset>1</offset>
					</li>
				</capMods>
                <statFactors>
                    <IncomingDamageFactor>0.6</IncomingDamageFactor>
                </statFactors>
			</li>
			<li>
				<minSeverity>0.5</minSeverity>
				<label>Corrupted</label>
			</li>
		</stages>
	</HediffDef>

	<!-- HediffMechanical -->

	<HediffDef>
		<defName>ATR_FractalPillMechanical</defName>
		<hediffClass>HediffWithComps</hediffClass>
		<label>Fractal Integration</label>
		<description>Fractal integration into the whole chassis. While the warping that occurs is harmless to the unit, the effects are decidedly double-edged. Indeed, an inflated ego and power consumption increase are the primary effects - although affected units inexplicably take less damage from the same blows, and have a stronger grasp on reality's true nature.\n\nPerhaps archotechs did not design fractal warping with machines in mind, and find its application to them uninteresting? Or, perhaps, fractal warping is a curse upon all things, not just organics?</description>
		<defaultLabelColor>(0.9,0.9,1)</defaultLabelColor>
		<scenarioCanAdd>true</scenarioCanAdd>
		<maxSeverity>1.0</maxSeverity>
		<isBad>false</isBad>
		<comps>
            <li Class="HediffCompProperties_HealPermanentWounds" />
		</comps>
		<stages>
			<li>
				<label>Little effect</label>
				<becomeVisible>false</becomeVisible>
			</li>
			<li>
				<minSeverity>0.25</minSeverity>
				<label>Awakened</label>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.15</offset>
					</li>
					<li>
						<capacity>Sight</capacity>
						<offset>0.1</offset>
					</li>
				</capMods>
				<statOffsets>
					<GlobalLearningFactor>0.25</GlobalLearningFactor>
					<MentalBreakThreshold>0.04</MentalBreakThreshold>
				</statOffsets>
                <statFactors>
                    <IncomingDamageFactor>0.95</IncomingDamageFactor>
                </statFactors>
			</li>
			<li>
				<minSeverity>0.5</minSeverity>
				<label>Illuminated</label>
				<hungerRateFactorOffset>1.25</hungerRateFactorOffset>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.15</offset>
					</li>
					<li>
						<capacity>Sight</capacity>
						<offset>0.1</offset>
					</li>
				</capMods>
				<statOffsets>
					<GlobalLearningFactor>0.5</GlobalLearningFactor>
					<MentalBreakThreshold>0.08</MentalBreakThreshold>
				</statOffsets>
                <statFactors>
                    <IncomingDamageFactor>0.9</IncomingDamageFactor>
                </statFactors>
			</li>
			<li>
				<minSeverity>0.7</minSeverity>
				<label>Enlightened</label>
				<hungerRateFactorOffset>1.5</hungerRateFactorOffset>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.3</offset>
					</li>
					<li>
						<capacity>Sight</capacity>
						<offset>0.2</offset>
					</li>
				</capMods>
				<mentalStateGivers>
					<li>
						<mentalState>WanderConfused</mentalState>
						<mtbDays>40</mtbDays>
					</li>
				</mentalStateGivers>
				<statOffsets>
					<GlobalLearningFactor>0.75</GlobalLearningFactor>
					<MentalBreakThreshold>0.12</MentalBreakThreshold>
				</statOffsets>
                <statFactors>
                    <IncomingDamageFactor>0.85</IncomingDamageFactor>
                </statFactors>
			</li>
			<li>
				<minSeverity>1</minSeverity>
				<label>Transcendant</label>
				<hungerRateFactorOffset>2</hungerRateFactorOffset>
				<capMods>
					<li>
						<capacity>Consciousness</capacity>
						<offset>0.6</offset>
					</li>
					<li>
						<capacity>Sight</capacity>
						<offset>0.4</offset>
					</li>
				</capMods>
				<mentalStateGivers>
					<li>
						<mentalState>WanderConfused</mentalState>
						<mtbDays>20</mtbDays>
					</li>
				</mentalStateGivers>
				<statOffsets>
					<GlobalLearningFactor>1</GlobalLearningFactor>
					<MentalBreakThreshold>0.16</MentalBreakThreshold>
				</statOffsets>
                <statFactors>
                    <IncomingDamageFactor>0.8</IncomingDamageFactor>
                </statFactors>
			</li>
		</stages>
	</HediffDef>

</Defs>
